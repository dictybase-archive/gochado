[create_table_temp_gpad]
    CREATE TEMP TABLE temp_gpad (
           digest varchar(28) NOT NULL,
           id varchar(56) NOT NULL,
           qualifier varchar(15) NOT NULL,
           goid varchar(30) NOT NULL,
           publication_id varchar(56) NOT NULL,
           pubplace varchar(28) NOT NULL,
           evidence_code varchar(10) NOT NULL,
           assigned_by varchar(15) NOT NULL,
           date_curated text NOT NULL
    )

[create_table_temp_gpad_reference]
    CREATE TEMP TABLE temp_gpad_reference (
           digest varchar(28) NOT NULL,
           pubplace varchar(28) NOT NULL,
           publication_id varchar(56)
    )


[create_table_temp_gpad_withfrom]
    CREATE TEMP TABLE temp_gpad_withfrom (
           digest varchar(28) NOT NULL,
           withfrom varchar(56) 
    )


[create_table_temp_gpad_new]
    CREATE TEMP TABLE temp_gpad_new (
           digest varchar(28) NOT NULL,
           id varchar(56) NOT NULL,
           qualifier varchar(15) NOT NULL,
           goid varchar(30) NOT NULL,
           publication_id varchar(56) NOT NULL,
           pubplace varchar(28) NOT NULL,
           evidence_code varchar(10) NOT NULL,
           assigned_by varchar(15) NOT NULL,
           date_curated text NOT NULL
    )

[select_latest_goa_from_staging]
    INSERT INTO temp_gpad_new(digest, id, qualifier,
        goid, publication_id, pubplace, evidence_code,
        assigned_by, date_curated)
    SELECT digest, id, qualifier, goid, publication_id, pubplace,
        evidence_code, assigned_by, date_curated
        FROM temp_gpad, 
        (SELECT fcvtprop2.value date_curated,
              FROM feature_cvterm fcvt
              JOIN feature feat
              ON fcvt.feature_id = feat.feature_id
              JOIN cvterm go
              ON go.cvterm_id = fcvt.cvterm_id
              JOIN dbxref goxref
              ON goxref.dbxref_id = go.dbxref_id
              JOIN db godb
              ON godb.db_id = goxref.db_id
              JOIN cv gocv
              ON gocv.cv_id = go.cv_id
              JOIN feature_cvtermprop fcvtprop
              ON fcvtprop.feature_cvterm_id = fcvt.feature_cvterm_id
              JOIN cvterm evterm
              ON evterm.cvterm_id = fcvtprop.type_id
              JOIN cv ecv
              ON ecv.cv_id = evterm.cv_id
              JOIN dbxref exref
              ON evterm.dbxref_id = exref.dbxref_id
              JOIN db edb 
              ON exref.db_id = edb.db_id
             JOIN feature_cvtermprop fcvtprop2
              ON fcvtprop2.feature_cvterm_id = fcvt.feature_cvterm_id
              JOIN cvterm dterm
              ON dterm.cvterm_id = fcvtprop3.type_id
              JOIN cv dcv
              ON dcv.cv_id = dterm.cv_id
              JOIN organism
              ON organism.organism_id    = feat.organism_id
              WHERE organism.genus = $1
              AND organism.species = $2
              AND dterm.name             = 'date'
              AND dcv.name               = 'gene_ontology_association'
              AND godb.name              = 'GO'
              AND ecv.name               = 'eco'
              AND edb.name               = 'ECO'
              AND gocv.name IN ('biological_process', 'molecular_function', 'cellular_component')
              ORDER BY fcvtprop2.value DESC
              LIMIT 1
            ) chado_gpad_date

        WHERE
            CAST(temp_gpad.date_curated AS INT) > CAST(chado_gpad_date.date_curated AS INT)

[insert_feature_cvterm]
